(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{e2QP:function(l,n,t){"use strict";t.r(n);var e=t("8Y7J"),u=t("mrSG"),o=t("IheW"),i=t("AytR"),r=t("ZZ/e"),s=t("EnSQ");class a{constructor(l,n,t,e,u,o){this.ds=l,this.http=n,this.socket=t,this.route=e,this.router=u,this.toastController=o,this.items=[],this.showPlayer=!0}ngOnInit(){this.roomId=this.route.snapshot.paramMap.get("id"),this.roomId||this.router.navigate(["/home"]),this.getRoomAdmin(),this.socket.connect(),this.socket.emit("createRoom",{roomId:this.roomId}),this.socket.fromEvent("update").subscribe(()=>{this.getPlaylistForRoom()}),this.getPlaylistForRoom()}getRoomAdmin(){this.http.get(`${i.a.SERVER_URL}/playlists/${this.roomId}`).subscribe(l=>{l&&l.user.length>0&&l.user!==localStorage.getItem("username")&&this.router.navigate(["/home"])})}getPlaylistForRoom(){this.http.get(`${i.a.SERVER_URL}/songs/${this.roomId}`).subscribe(l=>{this.items=l,this.currentSong=this.items.filter(l=>l.playlists.find(l=>l.roomId===this.roomId&&l.isCurrent))[0],this.currentSongIndex=this.items.indexOf(this.currentSong)})}onStateChange(l){this.ytEvent=l.data,0===this.ytEvent&&this.playNextSong(this.items[this.currentSongIndex+1]?this.items[this.currentSongIndex+1]._id:this.items[0]._id)}removeSongFromPlaylist(l){if(l._id!==this.currentSong._id){let n={headers:new o.g({"Content-Type":"application/json"}),body:{roomId:this.roomId,song:l}};this.http.delete(`${i.a.SERVER_URL}/song`,n).subscribe(l=>this.presentToastWithOptions(l))}}playNextSong(l){l!==this.currentSong._id&&(this.updateCurrentSong(l),this.player.loadVideoById(l))}updateCurrentSong(l){let n=this.items.filter(n=>n._id===l||n._id===this.currentSong._id).map(l=>{let n=l.playlists.findIndex(l=>l.roomId===this.roomId);return l.playlists[n].isCurrent=!l.playlists[n].isCurrent,l});this.http.put(`${i.a.SERVER_URL}/song`,{songs:n,roomId:this.roomId}).subscribe(l=>this.presentToastWithOptions(l))}savePlayer(l){this.player=l,this.playVideo()}playVideo(){this.player.playVideo()}pauseVideo(){this.player.pauseVideo()}presentToastWithOptions(l){return u.b(this,void 0,void 0,(function*(){(yield this.toastController.create({message:l.message,position:"bottom",duration:2e3,color:l.status,buttons:[{side:"start",icon:"musical-notes"},{icon:"close",role:"cancel"}]})).present()}))}}class c{}var h=t("pMnS"),b=t("oBZk");class d{constructor(){this.playSong=new e.m,this.deleteSong=new e.m}ngOnInit(){}deleteMe(){this.currentId!==this.result._id&&this.deleteSong.emit([this.result])}playMe(){this.currentId!==this.result._id&&this.playSong.emit([this.result._id])}}var g=e.pb({encapsulation:0,styles:[[".thumbnail[_ngcontent-%COMP%]{cursor:pointer}.title[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}.trash[_ngcontent-%COMP%]:hover{cursor:pointer}"]],data:{}});function p(l){return e.Lb(0,[(l()(),e.rb(0,0,null,null,12,"ion-item",[["class","item"]],[[1,"color",0]],null,null,b.I,b.m)),e.qb(1,49152,null,0,r.F,[e.h,e.k,e.x],{disabled:[0,"disabled"]},null),(l()(),e.rb(2,0,null,0,2,"ion-thumbnail",[["class","ion-margin-end thumbnail"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.playMe()&&e),e}),b.P,b.t)),e.qb(3,49152,null,0,r.xb,[e.h,e.k,e.x],null,null),(l()(),e.rb(4,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(l()(),e.rb(5,0,null,0,5,"ion-label",[],null,null,null,b.J,b.n)),e.qb(6,49152,null,0,r.L,[e.h,e.k,e.x],null,null),(l()(),e.rb(7,0,null,0,1,"h2",[["class","title"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.playMe()&&e),e}),null,null)),(l()(),e.Jb(8,null,["",""])),(l()(),e.rb(9,0,null,0,1,"p",[],null,null,null,null,null)),(l()(),e.Jb(10,null,["",""])),(l()(),e.rb(11,0,null,0,1,"ion-icon",[["class","ion-margin-start trash"],["color","danger"],["name","trash"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.deleteMe()&&e),e}),b.G,b.k)),e.qb(12,49152,null,0,r.A,[e.h,e.k,e.x],{color:[0,"color"],name:[1,"name"]},null)],(function(l,n){var t=n.component;l(n,1,0,t.result._id===t.currentId),l(n,12,0,"danger","trash")}),(function(l,n){var t=n.component;l(n,0,0,t.result._id===t.currentId?"primary":""),l(n,4,0,e.vb(1,"",t.result.thumbnail,"")),l(n,8,0,null==t.result?null:t.result.title),l(n,10,0,null==t.result?null:t.result.description)}))}var m=t("Fmad"),y=e.pb({encapsulation:2,styles:[],data:{}});function f(l){return e.Lb(2,[(l()(),e.rb(0,0,null,null,0,"div",[["id","yt-player-ngx-component"]],null,null,null,null,null))],null,null)}var v=t("SVse"),S=t("s7LF"),I=t("RH9n"),k=t("iInd"),x=e.pb({encapsulation:0,styles:[[""]],data:{}});function C(l){return e.Lb(0,[(l()(),e.rb(0,0,null,null,1,"app-playlist-item",[],null,[[null,"playSong"],[null,"deleteSong"]],(function(l,n,t){var e=!0,u=l.component;return"playSong"===n&&(e=!1!==u.playNextSong(t[0])&&e),"deleteSong"===n&&(e=!1!==u.removeSongFromPlaylist(t[0])&&e),e}),p,g)),e.qb(1,114688,null,0,d,[],{result:[0,"result"],currentId:[1,"currentId"]},{playSong:"playSong",deleteSong:"deleteSong"})],(function(l,n){l(n,1,0,n.context.$implicit,n.component.currentSong._id)}),null)}function q(l){return e.Lb(0,[(l()(),e.rb(0,0,null,null,7,"ion-card-content",[["class","ion-text-center"]],null,null,null,b.z,b.e)),e.qb(1,49152,null,0,r.l,[e.h,e.k,e.x],null,null),(l()(),e.rb(2,0,null,0,1,"youtube-player",[["width","70%"]],[[8,"hidden",0]],[[null,"ready"],[null,"change"]],(function(l,n,t){var e=!0,u=l.component;return"ready"===n&&(e=!1!==u.savePlayer(t)&&e),"change"===n&&(e=!1!==u.onStateChange(t)&&e),e}),f,y)),e.qb(3,1097728,null,0,m.b,[m.c,e.k,e.B],{videoId:[0,"videoId"],width:[1,"width"]},{ready:"ready",change:"change"}),(l()(),e.rb(4,0,null,0,3,"ion-list",[],null,null,null,b.K,b.o)),e.qb(5,49152,null,0,r.M,[e.h,e.k,e.x],null,null),(l()(),e.gb(16777216,null,0,1,null,C)),e.qb(7,278528,null,0,v.h,[e.M,e.J,e.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var t=n.component;l(n,3,0,t.currentSong._id,"70%"),l(n,7,0,t.items)}),(function(l,n){l(n,2,0,!n.component.showPlayer)}))}function _(l){return e.Lb(0,[e.Eb(0,v.n,[]),(l()(),e.rb(1,0,null,null,28,"ion-content",[],null,null,null,b.D,b.h)),e.qb(2,49152,null,0,r.s,[e.h,e.k,e.x],null,null),(l()(),e.rb(3,0,null,0,26,"ion-grid",[],null,null,null,b.E,b.i)),e.qb(4,49152,null,0,r.y,[e.h,e.k,e.x],null,null),(l()(),e.rb(5,0,null,0,24,"ion-row",[],null,null,null,b.L,b.p)),e.qb(6,49152,null,0,r.hb,[e.h,e.k,e.x],null,null),(l()(),e.rb(7,0,null,0,22,"ion-col",[["class","align-items-center justify-content-center"],["offset","2"],["size","8"]],null,null,null,b.C,b.g)),e.qb(8,49152,null,0,r.r,[e.h,e.k,e.x],{offset:[0,"offset"],size:[1,"size"]},null),(l()(),e.rb(9,0,null,0,20,"ion-card",[],null,null,null,b.B,b.d)),e.qb(10,49152,null,0,r.k,[e.h,e.k,e.x],null,null),(l()(),e.rb(11,0,null,0,16,"ion-card-header",[],null,null,null,b.A,b.f)),e.qb(12,49152,null,0,r.m,[e.h,e.k,e.x],null,null),(l()(),e.rb(13,0,null,0,2,"h1",[],null,null,null,null,null)),(l()(),e.Jb(14,null,["Room code: ",""])),e.Fb(15,1),(l()(),e.rb(16,0,null,0,11,"ion-item",[["lines","none"]],null,null,null,b.I,b.m)),e.qb(17,49152,null,0,r.F,[e.h,e.k,e.x],{lines:[0,"lines"]},null),(l()(),e.rb(18,0,null,0,2,"ion-label",[],null,null,null,b.J,b.n)),e.qb(19,49152,null,0,r.L,[e.h,e.k,e.x],null,null),(l()(),e.Jb(-1,0,["Show video player"])),(l()(),e.rb(21,0,null,0,6,"ion-toggle",[["checked",""],["name","blueberry"],["slot","start"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],(function(l,n,t){var u=!0,o=l.component;return"ionBlur"===n&&(u=!1!==e.Db(l,22)._handleBlurEvent(t.target)&&u),"ionChange"===n&&(u=!1!==e.Db(l,22)._handleIonChange(t.target)&&u),"ngModelChange"===n&&(u=!1!==(o.showPlayer=t)&&u),u}),b.Q,b.u)),e.qb(22,16384,null,0,r.b,[e.k],null,null),e.Gb(1024,null,S.b,(function(l){return[l]}),[r.b]),e.qb(24,671744,null,0,S.e,[[8,null],[8,null],[8,null],[6,S.b]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),e.Gb(2048,null,S.c,null,[S.e]),e.qb(26,16384,null,0,S.d,[[4,S.c]],null,null),e.qb(27,49152,null,0,r.zb,[e.h,e.k,e.x],{checked:[0,"checked"],name:[1,"name"]},null),(l()(),e.gb(16777216,null,0,1,null,q)),e.qb(29,16384,null,0,v.i,[e.M,e.J],{ngIf:[0,"ngIf"]},null)],(function(l,n){var t=n.component;l(n,8,0,"2","8"),l(n,17,0,"none"),l(n,24,0,"blueberry",t.showPlayer),l(n,27,0,"","blueberry"),l(n,29,0,t.currentSong)}),(function(l,n){var t=n.component,u=e.Kb(n,14,0,l(n,15,0,e.Db(n,0),t.roomId));l(n,14,0,u),l(n,21,0,e.Db(n,26).ngClassUntouched,e.Db(n,26).ngClassTouched,e.Db(n,26).ngClassPristine,e.Db(n,26).ngClassDirty,e.Db(n,26).ngClassValid,e.Db(n,26).ngClassInvalid,e.Db(n,26).ngClassPending)}))}function B(l){return e.Lb(0,[(l()(),e.rb(0,0,null,null,1,"app-tv",[],null,null,null,_,x)),e.qb(1,114688,null,0,a,[s.a,o.c,I.a,k.a,k.m,r.Jb],null,null)],(function(l,n){l(n,1,0)}),null)}var R=e.nb("app-tv",a,B,{},{},[]);t.d(n,"TvPageModuleNgFactory",(function(){return P}));var P=e.ob(c,[],(function(l){return e.Ab([e.Bb(512,e.j,e.Z,[[8,[h.a,R]],[3,e.j],e.v]),e.Bb(4608,v.k,v.j,[e.s,[2,v.s]]),e.Bb(4608,S.g,S.g,[]),e.Bb(4608,r.a,r.a,[e.x,e.g]),e.Bb(4608,r.Eb,r.Eb,[r.a,e.j,e.p]),e.Bb(4608,r.Hb,r.Hb,[r.a,e.j,e.p]),e.Bb(4608,m.c,m.c,[e.x]),e.Bb(1073742336,v.b,v.b,[]),e.Bb(1073742336,S.f,S.f,[]),e.Bb(1073742336,S.a,S.a,[]),e.Bb(1073742336,r.Cb,r.Cb,[]),e.Bb(1073742336,k.n,k.n,[[2,k.s],[2,k.m]]),e.Bb(1073742336,m.a,m.a,[]),e.Bb(1073742336,c,c,[]),e.Bb(1024,k.k,(function(){return[[{path:"",component:a}]]}),[])])}))}}]);